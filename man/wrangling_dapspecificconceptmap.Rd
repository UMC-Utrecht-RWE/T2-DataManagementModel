% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wrangling_dapspecificconceptmap.R
\name{wrangling_dapspecificconceptmap}
\alias{wrangling_dapspecificconceptmap}
\title{Transform DAP-specific concept map into a normalized long format}
\usage{
wrangling_dapspecificconceptmap(dap_specific_concept_map)
}
\arguments{
\item{dap_specific_concept_map}{A `data.table` formatted according to the
**RWE BRIDGE metadata scheme**, including at least the following columns:
\describe{
  \item{concept_id}{The harmonized concept identifier.}
  \item{cdm_table_name}{Name of the CDM table where the mapping applies.}
  \item{keep_value_column_name}{Column name whose value should be kept when applying the mapping.}
  \item{keep_date_column_name}{Column name containing the date associated with the record.}
  \item{column_name_*}{One or more columns specifying CDM columns to map.}
  \item{expected_value_*}{One or more columns specifying the expected code values corresponding to the CDM columns.}
}}
}
\value{
A `data.table` in long format with the following columns:
  \describe{
    \item{id_set}{Unique identifier for each mapping set.}
    \item{concept_id}{Harmonized concept identifier.}
    \item{cdm_table_name}{CDM table name (original).}
    \item{cdm_column}{Name of the CDM column being mapped.}
    \item{code}{Expected code for the CDM column.}
    \item{keep_value_column_name}{Column to retain as the value.}
    \item{keep_date_column_name}{Column to retain as the date.}
    \item{order_index}{Order index for hierarchical application of mappings.}
  }
}
\description{
This function reshapes a DAP-specific concept map (formatted according to the
RWE BRIDGE metadata specification) into a normalized long format suitable for
downstream processing and application of codelists. It expands the mapping by
melting multiple `column_name_*` and `expected_value_*` columns, and assigns an
`id_set` identifier to each original mapping entry.
}
\details{
This function:
\enumerate{
  \item Adds a unique identifier column `id_set` for tracking each mapping set.
  \item Dynamically identifies all `column_name_*` and `expected_value_*` columns.
  \item Converts the mapping into a long format, where each row corresponds to
        a specific combination of CDM column and expected value.
  \item Assigns an `order_index` based on the original column order.
}

The resulting structure supports hierarchical processing of concept mappings
when applying them to a CDM database.
}
\examples{
\dontrun{
# Assuming dap_specific_concept_map follows the RWE BRIDGE format:
long_map <- wrangling_dapspecificconceptmap(dap_specific_concept_map)
}

}
