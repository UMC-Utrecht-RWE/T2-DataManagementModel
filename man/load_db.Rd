% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/load_db_main.R
\name{load_db}
\alias{load_db}
\title{Load Source Data into a DuckDB CDM Database}
\usage{
load_db(
  data_model = "conception",
  excel_path_to_cdm_schema = "./ConcePTION_CDM tables v2.2.xlsx",
  format_source_files = "parquet",
  folder_path_to_source_files = "",
  through_parquet = "yes",
  file_path_to_target_db = "",
  create_db_as = "views",
  verbosity = 1
)
}
\arguments{
\item{data_model}{Character.
The data model to use (e.g., `"conception"`).}

\item{excel_path_to_cdm_schema}{Character.
Path to the Excel file containing the CDM schema.}

\item{format_source_files}{Character.
Format of the source files, either `"csv"` or `"parquet"`.}

\item{folder_path_to_source_files}{Character.
Path to the folder containing source files.
Ensure the path ends with a `'/'`.}

\item{through_parquet}{Character.
Whether to process through Parquet files (`"yes"` or `"no"`).}

\item{file_path_to_target_db}{Character.
Full path to the target database file, including the `".duckdb"` extension.}

\item{create_db_as}{Character.
Specify whether to create the database as `"views"` or `"tables"`.}

\item{verbosity}{Integer.
Level of verbosity for logging; `0` for minimal output, `1` for detailed output.}
}
\value{
None.
The function performs operations to load data into a DuckDB database.
}
\description{
This function orchestrates the full pipeline for loading source data into a
 Common Data Model (CDM) structure using DuckDB. It validates inputs, sets up
 schemas, reads source files, creates empty CDM tables, populates them, and
 optionally combines intermediate Parquet views.
}
\details{
The function performs the following steps:
\enumerate{
  \item Validates input parameters.
  \item Sets up the DuckDB connection and creates necessary schemas.
  \item Reads source files and creates SQL views.
  \item Creates empty CDM tables based on the schema definition.
  \item Populates CDM tables from source views.
  \item Optionally combines intermediate Parquet views into final views.
  \item Closes the database connection and performs cleanup.
}
}
\examples{
\dontrun{
load_db(
  data_model = "conception",
  excel_path_to_cdm_schema = "./ConcePTION_CDM tables v2.2.xlsx",
  format_source_files = "csv",
  folder_path_to_source_files = "data/source/",
  through_parquet = "no",
  file_path_to_target_db = "data/target/my_database.duckdb",
  create_db_as = "tables",
  verbosity = 1
)
}

}
